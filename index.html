<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chanchito Cacheuta üö£‚Äç‚ôÇÔ∏è</title>
    <style>
        :root { --primary: #ff85a2; --magic: #7d5fff; --bg: #fdf2f4; --text: #333; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; margin: 0; }
        .container { background: white; border-radius: 25px; padding: 25px; box-shadow: 0 15px 35px rgba(255,133,162,0.2); max-width: 450px; width: 100%; text-align: center; border: 2px solid #ffdeeb; }
        h1 { color: var(--primary); margin-bottom: 5px; font-size: 22px; }
        .chanchito { font-size: 70px; margin: 15px 0; animation: bounce 2s infinite ease-in-out; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        .progress-bar { background: #eee; height: 18px; border-radius: 10px; overflow: hidden; margin: 10px 0; position: relative; }
        .progress { background: linear-gradient(90deg, var(--primary), var(--magic)); height: 100%; width: 0%; transition: 1s cubic-bezier(0.17, 0.67, 0.83, 0.67); }
        .stats { background: #fff9fa; padding: 18px; border-radius: 20px; text-align: left; margin: 15px 0; border: 1px dashed var(--primary); }
        .meta-diaria { color: var(--magic); font-size: 1.4em; font-weight: bold; text-align: center; display: block; margin-top: 10px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        
        .input-box { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; background: #f8f0ff; padding: 15px; border-radius: 15px; }
        input, select { padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; outline: none; }
        button { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.3s; }
        button:hover { background: var(--magic); transform: scale(1.02); }
        
        .history { margin-top: 25px; text-align: left; max-height: 250px; overflow-y: auto; padding-right: 5px; }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #f0f0f0; font-size: 0.9em; }
        .spell-tag { background: #efecff; color: var(--magic); padding: 2px 8px; border-radius: 5px; font-size: 0.8em; font-weight: bold; border: 1px solid #dcd6ff; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #ffdeeb; border-radius: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>Cacheuta 2026 üö£‚Äç‚ôÇÔ∏è</h1>
    <div class="chanchito">üê∑</div>
    
    <div class="progress-bar"><div class="progress" id="progressBar"></div></div>
    <p style="font-size: 14px; color: #888; margin-bottom: 20px;"><span id="porcText">0</span>% del viaje completado</p>
    
    <div class="stats">
        <p>üéØ Meta Total: <b>$301.000</b></p>
        <p>üí∞ Llevamos: <b id="ahorradoText">$0</b></p>
        <p>‚è≥ D√≠as para el 3 de Abril: <b id="diasText">0</b></p>
        <hr style="border:0; border-top: 1px solid #eee;">
        <span style="text-align: center; display: block; font-size: 13px;">DEBEN AHORRAR:</span>
        <span class="meta-diaria">$<span id="metaDiariaText">0</span> / d√≠a</span>
    </div>

    <div class="input-box">
        <input type="number" id="montoInput" placeholder="Monto a guardar ($)">
        <select id="spellSelect">
            <option value="Ahorro Com√∫n">Sin hechizo</option>
            <optgroup label="Ataque">
                <option value="Expelliarmus">Expelliarmus (Desarmar deudas)</option>
                <option value="Incendio">Incendio (Quemar gastos)</option>
            </optgroup>
            <optgroup label="Defensa">
                <option value="Petrificus Totalus">Petrificus (Congelar precios)</option>
                <option value="Confundus">Confundus (A la inflaci√≥n)</option>
            </optgroup>
            <optgroup label="Maldici√≥n">
                <option value="Imperio">Imperio (Controlar billetera)</option>
                <option value="Sectumsempra">Sectumsempra (Cortar gastos)</option>
            </optgroup>
        </select>
        <button onclick="guardar()">¬°Lanzar Hechizo y Guardar! ‚ú®</button>
    </div>

    <div class="history" id="historial">
        </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  // --- REEMPLAZA ESTO CON TUS DATOS DE FIREBASE ---
  const firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_PROYECTO.firebaseapp.com",
    databaseURL: "https://chanchito-10e8e-default-rtdb.firebaseio.com",
    projectId: "chanchito-10e8e",
    storageBucket: "chanchito-10e8e.appspot.com",
    messagingSenderId: "TU_ID",
    appId: "TU_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const ahorrosRef = ref(db, 'ahorros');

  const META_TOTAL = 301000;
  const FECHA_VIAJE = new Date('2026-04-03');

  onValue(ahorrosRef, (snapshot) => {
    const data = snapshot.val();
    let total = 0;
    let html = "<b>üìú Historial de Hechizos:</b><br>";
    
    if (data) {
        const items = Object.values(data).reverse();
        items.forEach(item => {
            total += Number(item.monto);
            html += `
                <div class="history-item">
                    <div>
                        <b>$${item.monto.toLocaleString()}</b><br>
                        <small>${item.fecha}</small>
                    </div>
                    <span class="spell-tag">${item.hechizo}</span>
                </div>`;
        });
    }

    const hoy = new Date();
    const diff = FECHA_VIAJE - hoy;
    const dias = Math.max(1, Math.ceil(diff / (1000 * 60 * 60 * 24)));
    const falta = Math.max(0, META_TOTAL - total);
    const diaria = falta / dias;
    const porc = (total / META_TOTAL) * 100;

    document.getElementById('ahorradoText').innerText = `$${total.toLocaleString()}`;
    document.getElementById('diasText').innerText = dias;
    document.getElementById('metaDiariaText').innerText = Math.round(diaria).toLocaleString();
    document.getElementById('progressBar').style.width = Math.min(100, porc) + "%";
    document.getElementById('porcText').innerText = porc.toFixed(1);
    document.getElementById('historial').innerHTML = html;
  });

  window.guardar = function() {
    const monto = document.getElementById('montoInput').value;
    const hechizo = document.getElementById('spellSelect').value;
    
    if (monto > 0) {
        push(ahorrosRef, {
            monto: parseFloat(monto),
            hechizo: hechizo,
            fecha: new Date().toLocaleDateString('es-AR')
        });
        document.getElementById('montoInput').value = "";
        alert("¬°Hechizo lanzado con √©xito! ü™Ñ‚ú®");
    }
  }
</script>
</body>
</html>

